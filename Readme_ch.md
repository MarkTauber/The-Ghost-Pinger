# Ghost Pinger - 静默局域网扫描器（适用于内部威胁场景）

![Windows Batch](https://img.shields.io/badge/Windows-Batch-blue)
![无依赖](https://img.shields.io/badge/No_Dependencies-None-green)
![隐蔽模式](https://img.shields.io/badge/Mode-Stealth-yellow)

⚠️ **翻译说明**：本文件由人工智能辅助翻译。虽然已尽力确保准确性，但仍可能存在术语或表达上的误差。
如果文本中有任何错误，请告诉我，我会立即修正。

**Ghost Pinger** 是一个独立运行的 Windows 批处理脚本（`cmd`），专为内部攻击者进行网络侦察而设计。它无需第三方工具即可探测局域网中的活跃主机，非常适合权限受限、安全策略严格的受限环境。

> 本项目适用于无法安装或使用 `nmap`、`PowerShell` 脚本等工具的场景。

---

<br>

## 用途

脚本通过 ICMP（ping）请求执行**静默 IP 范围扫描**，并自动：
- 检测活跃主机
- 通过 ARP 表收集 MAC 地址
- 将结果记录到带时间戳的文件中
- 支持多种输入方式
- 灵活配置扫描参数（超时、重试次数）

适用于横向移动的早期阶段：攻击者已进入内网，但需要绘制活跃设备地图以进行后续探测。


---

<br>

## 功能

### 支持的扫描模式
- 手动输入 IP 范围（例如 `192.168.1`）
- 起始 IP + 数量（例如 `192.168.1.10-50`）
- 常见局域网预设：
  - `192.168.1.0/24`
  - `192.168.0.0/24`
  - `10.0.0.0/8`
  - `172.16.0.0/12`
- CIDR 表示法（例如 `192.168.10.0/24`），支持子网与广播地址的精确计算

### 额外功能
- 自动检测本机 IP 地址
- 可配置 ping 超时与尝试次数
- 结果保存为 `.txt` 文件并带时间戳
- 显示统计信息：活跃主机数、成功率
- 扫描后可查看或打开日志文件
- 支持无需重启的重复扫描

### 数据收集
- 记录活跃 IP 地址
- 通过 `arp -a` 提取 MAC 地址
- 生成完整扫描报告

---

<br>

## 系统要求

- 操作系统：Windows 7 / 8 / 10 / 11 / Server（x86 或 x64）
- 所需内置工具：
  - `ping.exe`
  - `ipconfig.exe`
  - `arp.exe`
  - `wmic.exe`（用于生成时间戳）
- 权限要求：普通用户权限即可运行（无需管理员权限）
- 限制：无需外部依赖，无需安装

> 注意：若系统禁用 `wmic`，时间戳将被跳过，但脚本仍可正常运行。

---

<br>

## 使用方法

1. 将 `GhostPinger.bat` 复制到目标系统（例如通过U盘）。
2. 双击或通过 `cmd` 运行。
3. 选择 IP 范围输入方式：
   - 手动输入
   - CIDR
   - 预设网络
4. 配置扫描参数：
   - Ping 超时（毫秒）
   - 尝试次数
5. 开始扫描。
6. 结果将保存为 `scan_results_YYYY-MM-DD_HH-MM-SS.txt` 文件。

扫描完成后可选择：
- 在控制台查看结果
- 用记事本打开日志
- 开始新一轮扫描


---

<br>

## 示例输出

```
SCAN CONFIGURATION
Network: 192.168.1.1 to 192.168.1.254
Ping timeout: 1000ms
Ping attempts: 1
Total hosts to scan: 254
Output file: scan_results_2025-01-31_15-15-56.txt
```

**结果文件内容：**
```
Network Scan Results 
==================== 
Network: 192.168.1.1-10
Range: 192.168.1.1-10
Date: 31.01.2025 15:15:15,15
Ping timeout: 1000ms 
Ping attempts: 1 
Total hosts to scan: 510 
================================================ 

192.168.1.1 - ACTIVE
  MAC: 00-11-22-33-44-55     динамический 

192.168.1.10 - ACTIVE
  MAC: aa-bb-cc-dd-ee-ff     динамический 

================================================ 
SCAN STATISTICS 
================================================ 
Active hosts: 2 
Total hosts scanned: 10
Success rate: 20% 
Scan completed: 31.01.2025 15:15:56,78 
```

---

<br>

---

## 优势

| 优点 | 说明 |
|------|------|
| **零依赖** | 仅使用 Windows 内置工具 |
| **无需管理员权限** | 普通用户即可运行 |
| **隐蔽性强** | 网络流量极小，仅使用 ICMP |
| **自包含** | 即拷即用，无需编译或安装 |
| **支持 CIDR** | 精确处理任意大小的子网 |
| **自动日志** | 结果自动保存并带时间戳 |

---

<br>

## 局限性与风险

| 缺点 | 说明 |
|------|------|
| **仅支持 ICMP** | 无法检测禁 ping 的主机 |
| **无多线程** | 扫描速度可能较慢（尤其大网段） |
| **无端口分析** | 仅判断主机可达性 |
| **ARP 可能为空** | 若未通信，MAC 地址无法获取 |
| **依赖 wmic** | 某些环境中 `wmic` 可能被禁用 |

---

<br>

## 使用建议

- 在获取初始访问权限后的“干净系统”上运行。
- 结合其他方法使用：扫描后尝试连接 SMB、HTTP、RDP 等服务。
- 使用较短 IP 范围，以减少扫描时间和网络噪音。
- 混淆文件名（例如 `update.bat`、`diag_tool.cmd`）。
- 通过隐蔽通道（如 DNS 隧道、U盘）导出结果。

---

<br>

## Структура проекта

```
GhostPinger/
├── Ghost_pinger.bat # 主脚本
├── Ghost_min.bat # 精简版
├── README.md # 文档（英语）
├── README_ru.md # 俄语版本
└── README_ch.md # 中文版本
```

<br>
<br>

---

> **Ghost Pinger** - 你在企业网络黑暗中的静默手电筒。  
> 打开它，发现还有谁“活着”。