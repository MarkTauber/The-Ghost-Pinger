# Ghost Pinger - Тихий сканер локальной сети (для внутреннего нарушителя)

![Windows Batch](https://img.shields.io/badge/Windows-Batch-blue)
![No Dependencies](https://img.shields.io/badge/No_Dependencies-None-green)
![Stealth Mode](https://img.shields.io/badge/Mode-Stealth-yellow)

**Ghost Pinger** - это автономный скрипт на языке командного интерпретатора Windows (`cmd`), предназначенный для проведения сетевой разведки от лица внутреннего нарушителя. Позволяет обнаруживать активные хосты в локальной сети без использования сторонних инструментов, что делает его идеальным для работы в защищённых средах с минимальными правами и строгими ограничениями.

> Проект создан для использования в условиях, когда установка и\или использование `nmap`, `PowerShell`-скриптов или других инструментов невозможны.

---

<br>

## Назначение

Скрипт выполняет тихое сканирование IP-диапазонов с помощью ICMP-запросов (ping) и автоматически:
- Определяет активные хосты
- Собирает MAC-адреса через ARP-таблицу
- Логирует результаты в файл
- Поддерживает несколько режимов ввода
- Гибкая настройка сканирования (таймаут, количество ретраев)

Используется на ранних этапах пивотирования, когда атакующий уже находится внутри сети, но нуждается в карте активных устройств для дальнейшего исследования.

---

<br>

## Функционал

### Поддерживаемые режимы сканирования
- Ручной ввод диапазона IP (например, `192.168.1`)
- Диапазон с количеством (например, `192.168.1.10-50`)
- Автоматический выбор типовых локальных сетей:
  - `192.168.1.0/24`
  - `192.168.0.0/24`
  - `10.0.0.0/8`
  - `172.16.0.0/12`
- CIDR-нотация (например, `192.168.10.0/24`) с корректным расчётом подсети и широковещательного адреса

### Дополнительные возможности
- Автоопределение IP-адреса хоста
- Настройка таймаута и количества пингов
- Сохранение результатов в `.txt` с временной меткой
- Отображение статистики: количество активных хостов, процент успеха
- Возможность просмотра или открытия лога после сканирования
- Поддержка повторных сканирований без перезапуска

### Сбор данных
- Запись активных IP-адресов
- Извлечение MAC-адресов через `arp -a`
- Формирование отчёта с полной информацией

---

<br>

## Требования

- ОС: Windows 7 / 8 / 10 / 11 / Server (x86 или x64)
- Требуемые утилиты (встроены в Windows):
  - `ping.exe`
  - `ipconfig.exe`
  - `arp.exe`
  - `wmic.exe` (для временной метки)
- Права: Работает под обычной учётной записью (без прав администратора)
- Ограничения: Не требует установки, не использует внешние зависимости

> Примечание: если `wmic` отключён в системе, временная метка будет пропущена, но скрипт продолжит работать.

---

<br>

## Как использовать

1. Скопируйте `GhostPinger.bat` на целевую систему (например, с флешки).
2. Запустите двойным кликом или через `cmd`.
3. Выберите режим ввода IP-диапазона:
   - Вручную
   - По CIDR
   - Из списка типовых сетей
4. Настройте параметры сканирования:
   - Таймаут пинга (мс)
   - Количество попыток
5. Запустите сканирование.
6. Результаты будут сохранены в файл `scan_results_YYYY-MM-DD_HH-MM-SS.txt`.

После завершения:
- Можно просмотреть результаты в консоли
- Открыть файл в Notepad
- Запустить новое сканирование

---

<br>

## Пример вывода

```
SCAN CONFIGURATION
Network: 192.168.1.1 to 192.168.1.254
Ping timeout: 1000ms
Ping attempts: 1
Total hosts to scan: 254
Output file: scan_results_2025-01-31_15-15-56.txt
```

**В файле результатов:**
```
Network Scan Results 
==================== 
Network: 192.168.1.1-10
Range: 192.168.1.1-10
Date: 31.01.2025 15:15:15,15
Ping timeout: 1000ms 
Ping attempts: 1 
Total hosts to scan: 510 
================================================ 

192.168.1.1 - ACTIVE
  MAC: 00-11-22-33-44-55     динамический 

192.168.1.10 - ACTIVE
  MAC: aa-bb-cc-dd-ee-ff     динамический 

================================================ 
SCAN STATISTICS 
================================================ 
Active hosts: 2 
Total hosts scanned: 10
Success rate: 20% 
Scan completed: 31.01.2025 15:15:56,78 
```

---

<br>

## Преимущества

| Плюс | Описание |
|------|---------|
| **Нулевая зависимость** | Работает только на встроенных утилитах Windows |
| **Не требует прав** | Может запускаться от обычного пользователя |
| **Тихий режим** | Минимальный сетевой шум, только ICMP |
| **Автономность** | Готов к запуску - не нужно компилировать или устанавливать |
| **CIDR-поддержка** | Корректно обрабатывает подсети любого размера |
| **Логирование** | Автоматическое сохранение результатов с меткой времени |

---

<br>

## Ограничения и риски

| Минус | Описание |
|------|---------|
| **Только ICMP** | Не обнаруживает хосты с заблокированным ping |
| **Нет многопоточности** | Сканирование может быть медленным (особенно в больших сетях) |
| **Нет анализа портов** | Только факт доступности по ping |
| **ARP может быть пустым** | Если хост не общался с системой, MAC-адрес не определится |
| **Зависит от wmic** | В некоторых защищённых средах `wmic` может быть отключён |

---

<br>

## Рекомендации по использованию

- Запускать на "чистой" системе после получения первоначального доступа.
- Комбинировать с другими методами: после сканирования - попробовать подключение к SMB, HTTP, RDP.
- Использовать короткие диапазоны, чтобы минимизировать время и шум.
- Обфусцировать имя файла (например, `update.bat`, `diag_tool.cmd`).
- Выгружать результаты через безымянные каналы (например, через DNS-туннели или USB).

---

<br>

## Структура проекта

```
GhostPinger/
├── GhostPinger.bat # Основной скрипт
└── README.md # Документация
```

<br>
<br>

---

> **Ghost Pinger** - ваш тихий фонарик в темноте корпоративной сети.  
> Включайте - и находите, кто ещё живёт рядом.
